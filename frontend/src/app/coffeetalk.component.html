<header class="app-header">
	<mat-toolbar color="primary" class="header-toolbar">
		<span>{{ title }}</span>
		<span class="spacer"></span>
		<button mat-icon-button (click)="toggleMenu()" aria-label="Menu">
			<mat-icon>menu</mat-icon>
		</button>
	</mat-toolbar>
	<div *ngIf="showMenu" class="custom-dropdown-menu">
		<button class="dropdown-item" (click)="openAddDialog()">
			<mat-icon>add</mat-icon>
			<span>Add New</span>
		</button>
		<button class="dropdown-item" (click)="closeMenu()">
			<mat-icon>settings</mat-icon>
			<span>Preferences</span>
		</button>
	</div>
</header>

<!-- Add New Dialog -->
<div *ngIf="showAddDialog" class="add-dialog-backdrop" (click)="closeAddDialog()">
	<div class="add-dialog" (click)="$event.stopPropagation()">
		<h3>Add New Coffee</h3>
		<input type="file" accept="image/*" (change)="onImageSelected($event)" />
		<div class="preview-img">
			<img [src]="newImage ? newImage : brownPreview" alt="Preview" width="100" height="100" />
		</div>
		<input type="text" maxlength="20" [(ngModel)]="newBrand" placeholder="Brand (max 20 chars)" />
		<input type="text" maxlength="20" [(ngModel)]="newName" placeholder="Name (max 20 chars)" />
		<input type="text" maxlength="20" [(ngModel)]="newType" placeholder="Type (e.g. Espresso)" />
		<input type="text" maxlength="30" [(ngModel)]="newCountryOfOrigin" placeholder="Country of Origin" />
		<input type="text" maxlength="30" [(ngModel)]="newBeanVariety" placeholder="Bean Variety" />
		<textarea maxlength="1024" [(ngModel)]="newNotes" placeholder="Notes"></textarea>
		<label>Rating:
			<input type="number" min="1" max="5" [(ngModel)]="newRating" />
		</label>
		<div class="dialog-actions">
			<button (click)="addNewCoffee()" [disabled]="!canAddNewCoffee()">Add</button>
			<button (click)="closeAddDialog()">Cancel</button>
		</div>
	</div>
</div>

<div class="main-content">
	<div class="coffee-grid">
		<div class="coffee-item" *ngFor="let item of coffeeItems">
			<div class="coffee-image" style="width:100px;height:100px;">
				<img *ngIf="item.image" [src]="item.image" width="100" height="100" alt="Coffee image" style="object-fit:cover;border-radius:4px;" />
				<div *ngIf="!item.image" [style.background]="randomBrown()" style="width:100px;height:100px;border-radius:4px;"></div>
			</div>
			<div class="coffee-brand">{{ item.brand }}</div>
			<div class="coffee-name">{{ item.name }}</div>
		</div>
	</div>
</div>